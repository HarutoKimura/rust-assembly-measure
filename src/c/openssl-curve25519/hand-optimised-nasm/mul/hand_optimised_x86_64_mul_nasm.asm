default rel
%define XMMWORD
%define YMMWORD
%define ZMMWORD
section .text


global open_ssl_curve25519_hand_optmised_fe51_mul_nasm
open_ssl_curve25519_hand_optmised_fe51_mul_nasm:
ALIGN 32
push rbp
push rbx
push r12
push r13
push r14
push r15
lea rsp,[rsp+-8*5]
mov rax,QWORD[rsi]
mov r11,QWORD[rdx]
mov r12,QWORD[rdx+8]
mov r13,QWORD[rdx+16]
mov rbp,QWORD[rdx+24]
mov r14,QWORD[rdx+32]
mov QWORD[rsp+32],rdi
mov rdi,rax
mul r11
mov QWORD[rsp],r11
mov rbx,rax
mov rax,rdi
mov rcx,rdx
mul r12
mov QWORD[rsp+8],r12
mov r8,rax
mov rax,rdi
lea r15,[r14+r14*8]
mov r9,rdx
mul r13
mov QWORD[rsp+16],r13
mov r10,rax
mov rax,rdi
lea rdi,[r14+r15*2]
mov r11,rdx
mul rbp
mov r12,rax
mov rax,QWORD[rsi]
mov r13,rdx
mul r14
mov r14,rax
mov rax,QWORD[rsi+8]
mov r15,rdx
mul rdi
add rbx,rax
mov rax,QWORD[rsi+16]
adc rcx,rdx
mul rdi
add r8,rax
mov rax,QWORD[rsi+24]
adc r9,rdx
mul rdi
add r10,rax
mov rax,QWORD[rsi+32]
adc r11,rdx
mul rdi
imul rdi,rbp,19
add r12,rax
mov rax,QWORD[rsi+8]
adc r13,rdx
mul rbp
mov rbp,QWORD[rsp+16]
add r14,rax
mov rax,QWORD[rsi+16]
adc r15,rdx
mul rdi
add rbx,rax
mov rax,QWORD[rsi+24]
adc rcx,rdx
mul rdi
add r8,rax
mov rax,QWORD[rsi+32]
adc r9,rdx
mul rdi
imul rdi,rbp,19
add r10,rax
mov rax,QWORD[rsi+8]
adc r11,rdx
mul rbp
add r12,rax
mov rax,QWORD[rsi+16]
adc r13,rdx
mul rbp
mov rbp,QWORD[rsp+8]
add r14,rax
mov rax,QWORD[rsi+24]
adc r15,rdx
mul rdi
add rbx,rax
mov rax,QWORD[rsi+32]
adc rcx,rdx
mul rdi
add r8,rax
mov rax,QWORD[rsi+8]
adc r9,rdx
mul rbp
imul rdi,rbp,19
add r10,rax
mov rax,QWORD[rsi+16]
adc r11,rdx
mul rbp
add r12,rax
mov rax,QWORD[rsi+24]
adc r13,rdx
mul rbp
mov rbp,QWORD[rsp]
add r14,rax
mov rax,QWORD[rsi+32]
adc r15,rdx
mul rdi
add rbx,rax
mov rax,QWORD[rsi+8]
adc rcx,rdx
mul rbp
add r8,rax
mov rax,QWORD[rsi+16]
adc r9,rdx
mul rbp
add r10,rax
mov rax,QWORD[rsi+24]
adc r11,rdx
mul rbp
add r12,rax
mov rax,QWORD[rsi+32]
adc r13,rdx
mul rbp
add r14,rax
adc r15,rdx
mov rdi,QWORD[rsp+32]
jmp open_ssl_curve25519_hand_optmised_fe51_mul_nasm.Lreduce51
open_ssl_curve25519_hand_optmised_fe51_mul_nasm.Lreduce51:
ALIGN 32
mov rbp,0x7ffffffffffff
mov rdx,r10
shr r10,51
shl r11,13
and rdx,rbp
or r11,r10
add r12,r11
adc r13,0
mov rax,rbx
shr rbx,51
shl rcx,13
and rax,rbp
or rcx,rbx
add r8,rcx
adc r9,0
mov rbx,r12
shr r12,51
shl r13,13
and rbx,rbp
or r13,r12
add r14,r13
adc r15,0
mov rcx,r8
shr r8,51
shl r9,13
and rcx,rbp
or r9,r8
add rdx,r9
mov r10,r14
shr r14,51
shl r15,13
and r10,rbp
or r15,r14
lea r14,[r15+r15*8]
lea r15,[r15+r14*2]
add rax,r15
mov r8,rdx
and rdx,rbp
shr r8,51
add rbx,r8
mov r9,rax
and rax,rbp
shr r9,51
add rcx,r9
mov QWORD[rdi],rax
mov QWORD[rdi+8],rcx
mov QWORD[rdi+16],rdx
mov QWORD[rdi+24],rbx
mov QWORD[rdi+32],r10
mov r15,QWORD[rsp+40]
mov r14,QWORD[rsp+48]
mov r13,QWORD[rsp+56]
mov r12,QWORD[rsp+64]
mov rbx,QWORD[rsp+72]
mov rbp,QWORD[rsp+80]
lea rsp,[rsp+88]
ret