default rel
%define XMMWORD
%define YMMWORD
%define ZMMWORD
section .text


global open_ssl_curve25519_hand_optmised_fe51_square_nasm
open_ssl_curve25519_hand_optmised_fe51_square_nasm:
ALIGN 32
push rbp
push rbx
push r12
push r13
push r14
push r15
lea rsp,[rsp+-8*5]
mov rax,QWORD[rsi]
mov r15,QWORD[rsi+16]
mov rbp,QWORD[rsi+32]
mov QWORD[rsp+32],rdi
lea r14,[rax+rax]
mul rax
mov rbx,rax
mov rax,QWORD[rsi+8]
mov rcx,rdx
mul r14
mov r8,rax
mov rax,r15
mov QWORD[rsp],r15
mov r9,rdx
mul r14
mov r10,rax
mov rax,QWORD[rsi+24]
mov r11,rdx
imul rdi,rbp,19
mul r14
mov r12,rax
mov rax,rbp
mov r13,rdx
mul r14
mov r14,rax
mov rax,rbp
mov r15,rdx
mul rdi
add r12,rax
mov rax,QWORD[rsi+8]
adc r13,rdx
mov rsi,QWORD[rsi+24]
lea rbp,[rax+rax]
mul rax
add r10,rax
mov rax,QWORD[rsp]
adc r11,rdx
mul rbp
add r12,rax
mov rax,rbp
adc r13,rdx
mul rsi
add r14,rax
mov rax,rbp
adc r15,rdx
imul rbp,rsi,19
mul rdi
add rbx,rax
lea rax,[rsi+rsi]
adc rcx,rdx
mul rdi
add r10,rax
mov rax,rsi
adc r11,rdx
mul rbp
add r8,rax
mov rax,QWORD[rsp]
adc r9,rdx
lea rsi,[rax+rax]
mul rax
add r14,rax
mov rax,rbp
adc r15,rdx
mul rsi
add rbx,rax
mov rax,rsi
adc rcx,rdx
mul rdi
add r8,rax
adc r9,rdx
mov rdi,QWORD[rsp+32]
jmp open_ssl_curve25519_hand_optmised_fe51_square_nasm.Lreduce51
open_ssl_curve25519_hand_optmised_fe51_square_nasm.Lreduce51:
ALIGN 32
mov rbp,0x7ffffffffffff
mov rdx,r10
shr r10,51
shl r11,13
and rdx,rbp
or r11,r10
add r12,r11
adc r13,0
mov rax,rbx
shr rbx,51
shl rcx,13
and rax,rbp
or rcx,rbx
add r8,rcx
adc r9,0
mov rbx,r12
shr r12,51
shl r13,13
and rbx,rbp
or r13,r12
add r14,r13
adc r15,0
mov rcx,r8
shr r8,51
shl r9,13
and rcx,rbp
or r9,r8
add rdx,r9
mov r10,r14
shr r14,51
shl r15,13
and r10,rbp
or r15,r14
lea r14,[r15+r15*8]
lea r15,[r15+r14*2]
add rax,r15
mov r8,rdx
and rdx,rbp
shr r8,51
add rbx,r8
mov r9,rax
and rax,rbp
shr r9,51
add rcx,r9
mov QWORD[rdi],rax
mov QWORD[rdi+8],rcx
mov QWORD[rdi+16],rdx
mov QWORD[rdi+24],rbx
mov QWORD[rdi+32],r10
mov r15,QWORD[rsp+40]
mov r14,QWORD[rsp+48]
mov r13,QWORD[rsp+56]
mov r12,QWORD[rsp+64]
mov rbx,QWORD[rsp+72]
mov rbp,QWORD[rsp+80]
lea rsp,[rsp+88]
ret